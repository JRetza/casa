<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>

<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd
file:///opt/casa/code/xmlcasa/xml/casa.xsd">

<task type="function" name="visstat" category="visibility statistics">
<shortdescription>Displays statistical information from a measurement set, or from a measurement set selection</shortdescription>

<input>
    <param type="string" name="vis" kind="ms" mustexist="true">
        <description>Name of input visibility file</description>
        <value></value>
        <example>vis='ngc5921.ms'</example>
    </param>

    <param type="string" name="column">
        <description>Column name</description>
        <value type="string">DATA</value>
        <example>column='DATA', column='SCAN_NUMBER'</example>
    </param>

    <param type="bool" name="useflags">
        <description>Take flagging into account?</description>
        <value>True</value>
        <example>useflags=True</example>
    </param>

                <param type="any" name="spw">
                        <description>spectral-window/frequency/channel</description>
                        <any type="variant" limittypes="string stringArray"/>
                        <value type="string"></value>
                </param>

                <param type="any" name="field">
                        <description>Field names or field index numbers: \'\'==>all, field=\'0~2,3C286\'</description>
                        <any type="variant" limittypes="string stringArray"/>
                        <value type="string"></value>
                </param>
                <param type="bool" name="selectdata">
                        <description>More data selection parameters (antenna, timerange etc)</description>
                        <value>True</value>
                </param>

                <param type="any" name="antenna" subparam="true">
                        <description>antenna/baselines: \'\'==>all, antenna = \'3,VA04\'</description>
                        <any type="variant" limittypes="string stringArray"/>
                        <value type="string"></value>
                </param>

                <param type="any" name="uvrange" subparam="true">
                        <description>uv range: \'\'==>all; uvrange = \'0~100klambda\', default units=meters</description>
                        <any type="variant" limittypes="string stringArray"/>
                        <value type="string"></value>
                </param>

                <param type="any" name="timerange" subparam="true">
                        <description>time range: \'\'==>all, timerange=\'09:14:0~09:54:0\'</description>
                        <any type="variant" limittypes="string stringArray"/>
                        <value type="string"></value>
                </param>

                <param type="any" name="correlation" subparam="true">
                        <description>Select data based on correlation</description>
                        <any type="variant" limittypes="string stringArray"/>
                        <value type="string"></value>
                </param>

                <param type="any" name="scan" subparam="true">
                        <description>scan numbers: \'\'==>all</description>
                        <any type="variant" limittypes="string stringArray"/>
                        <value type="string"></value>
                </param>

                <param type="any" name="array" subparam="true">
                        <description>(sub)array numbers: \'\'==>all</description>
                        <any type="variant" limittypes="string stringArray"/>
                        <value type="string"></value>
                </param>

    <constraints>
                        <when param="selectdata">
                                <equals type="bool" value="True">
                                        <default param="antenna"><value type="string"></value></default>
                                        <default param="timerange"><value type="string"></value></default>
                                        <default param="correlation"><value type="string"></value></default>
                                        <default param="scan"><value type="string"></value></default>
                                        <default param="array"><value type="string"></value></default>
                                        <default param="uvrange"><value type="string"></value></default>
                                </equals>
                                <equals type="bool" value="False"/>
                        </when>
    </constraints>
</input>
    <output>
    <param type="any" name="xstat">
    	<description>Statistical information for the selected measurement set</description>
	<any type="variant"/>
	<value>{}</value>
    </param>
    </output>
<returns type="void"/>

<example>

        This task returns statistical information about a measurement set column.
        The following values are computed: mean value, sum of values, sum of squared values,
        median, median absolute deviation, quartile, minimum, maximum,
        variance, standard deviation, root mean square.

        If selectdata = True, the statistical information is computed based only
        on the specified subset of the measurement set.

        Keyword arguments:

        vis  --- Name of input visibility file
                  default: '', example: vis='my.ms'

        column  -- Name of MS column to analyze
                default: ''
                column='DATA'
                column='SCAN_NUMBER'

        useflags -- Take MS flags into account
                default: False
                useflag=False
                useflag=True
        If useflags=False, flagged values are included in the statistics.
        If useflags=True, any flagged values are not used in the statistics.

        selectdata -- Other data selection parameters
                default: True
        antenna -- Select data based on baseline
                default: '' (all); example: antenna='5&amp;6' baseline 5-6
                antenna='5&amp;6;7&amp;8' #baseline 5-6 and 7-8
                antenna='5' # all baselines with antenna 5
                antenna='5,6' # all baselines with antennas 5 and 6
        spw -- Select data based on spectral window and channels
                default: '' (all); example: spw='1'
                spw='&lt;2' #spectral windows less than 2
                spw='&gt;1' #spectral windows greater than 1
                spw='0:0~10' # first 10 channels from spw 0
                spw='0:0~5;56~60' # multiple separated channel chunks.
        correlation -- Correlation types
                default: '' (all);
                example: correlation='RR LL'
        field -- Select data based on field id(s) or name(s)
                default: '' (all); example: field='1'
                field='0~2' # field ids inclusive from 0 to 2
                field='3C*' # all field names starting with 3C
        uvrange -- Select data within uvrange (default units meters)
                default: '' (all); example:
                uvrange='0~1000klambda'; uvrange from 0-1000 kilo-lamgda
                uvrange='&gt;4klamda';uvranges greater than 4 kilo-lambda
                uvrange='0~1000km'; uvrange in kilometers
        timerange  -- Select data based on time range:
                default = '' (all); example,
                timerange = 'YYYY/MM/DD/hh:mm:ss~YYYY/MM/DD/hh:mm:ss'
                Note: YYYY/MM/DD can be dropped as needed:
                timerange='09:14:0~09:54:0' # this time range
                timerange='09:44:00' # data within one integration of time
                timerange='&gt;10:24:00' # data after this time
                timerange='09:44:00+00:13:00' #data 13 minutes after time
        scan -- Select data based on scan number
                default: '' (all); example: scan='&gt;3'
        array -- Selection based on the antenna array

</example>

</task>

</casaxml>
