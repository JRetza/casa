<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>

<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd
file:///opt/casa/code/xmlcasa/xml/casa.xsd">

<!-- Documentation here.                                                -->

<task type="function" name="fixvis">

<shortdescription> Performs visibility adjustments. </shortdescription>
<description>
     This corrects visibilities, and/or their (u, v, w) positions, for various
     effects that can be calculated without fitting a model to the data.

     The effects include:
     \begin{itemize}
       \item calculating (u, v, w) coordinates,
       \item changing the phase tracking center(s),
       \item correcting for differential aberration,
       \item changing the refcode (i.e. B1950 to J2000 or 2006.78),
       \item changing the projection, as in (-)NCP to SIN.  (Not yet implemented),
       \item refocusing.
     \end{itemize}
</description>

<input>
    <param type="string" name="vis" kind="ms" mustexist="true">
        <description>Name of the input visibility set.</description>
        <value></value>
        <example>vis='ngc5921.ms'</example>
    </param>
    <param type="string" name="outputvis" kind="ms">
        <description>Name of the output visibility set.  (Can be the same as vis.)</description>
        <value></value>
        <example>vis='ngc5921\_fixedvis.ms'</example>
    </param>
    <param type="any" direction="in" name="fields">
      <description>Fields to operate on.  Blank = all.</description>
      <any type="variant"/>
      <value>""</value>
    </param>
    <param type="string" name="refcode">
        <description>Reference frame to use for the output.</description>
        <value></value>
        <example>refcode = 'J2000'</example>
    </param>
    <param type="string" name="proj">
        <description>Projection code to use for the output.</description>
        <value></value>
        <example>proj = 'SIN'</example>
    </param>
</input>

<!-- DIRTY HACK: <description> does not currently (2009-03-10) make it into help or ?,
                 but <example> does. -->
<!-- <description> -->
<example>
This task allows the user to adjust or correct the visibilities, including
their (u, v, w) coordinates, for various effects which do not require
fitting a model to the data.  (i.e. This is not a calibrater.)

The effects are:
  calculating (u, v, w) coordinates,
  changing the phase tracking center(s),
  correcting for differential aberration,
  changing the refcode (i.e. B1950 to J2000 or 2006.78),
  changing the projection, as in (-)NCP to SIN.  (Not yet implemented),
  and refocusing to a finite distance.

Input Parameters:

vis  --- Name of input visibility file
         ex: vis='my.ms'

outputvis --- Name of the output visibility set.  (Can be the same as vis.)
              ex: outputvis = 'myrefocused.ms'

fields    --- Selection string for the fields to operate on.  '' = all.

refcode   --- Reference frame to use for the output, i.e. 'J2000', 'B1950',
              'GALACTIC', etc..  A full list of codes can be gotten from
              'csys = cs.newcoordsys(True);csys.referencecode('dir', True);csys.done()'
              Cannot be changed when only some of the fields are selected.
              Default '' = refcode of input ms.
              ex: refcode = 'J2000'

proj      --- Projection code to use for the output.  A list of codes can be
              gotten from 'csys = cs.newcoordsys(True);csys.projection('all');csys.done()'
              Cannot be changed when only some of the fields are selected.
              Default '' = projection of input ms.
              ex: proj = 'TAN'

<!-- </description> -->

<!-- <example> -->
Example:

fixvis(vis='my.ms', outputvis='myrefocused.ms', '')

</example>

</task>

</casaxml>
