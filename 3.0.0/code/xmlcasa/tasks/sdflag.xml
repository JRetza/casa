<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>
<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd
file:///opt/casa/code/xmlcasa/xml/casa.xsd">


<!-- This is the param set for sdflag -->

<task type="function" name="sdflag" startup="false" category="single dish">

  <shortdescription>ASAP SD spectral flagging task </shortdescription>


  <description>
        ASAP SD spectral flagging task (based on the ALMATST5 recommendations):

        Task Version 2008-01-31 TT
</description>

  <input>

    <param type="string" name="sdfile"  mustexist="true">
    <description>name of input SD dataset</description>
    <value></value>
    </param>

    <param type="intArray" name="scanlist">
	    <description>list of scans to use (e.g. [1,2,3,4])</description>
	    <value></value>
    </param>

    <param type="string" name="field">
	    <description>string for selection by source name</description>
	    <value></value>
    </param>

    <param type="intArray" name="iflist">
	    <description>list of IF ids to select (e.g. [0,1])</description>
	    <value></value>
    </param>

    <param type="any" name="pollist">
	    <description>list of polarization by ids or names to select (e.g. [0,1])</description>
            <any type="variant" limittype="intArray stringArray"/>
	    <value type="intArray"></value>
    </param>

    <param type="intArray" name="maskflag">
            <description>list of mask regions to flag/unflag</description>
            <value></value>
    </param>

    <param type="intArray" name="flagrow">
            <description>list of row numbers to apply row-based flagging/unflagging</description>
            <value></value>
    </param>

    <param type="string" name="flagmode">
            <description>flag mode (flag,unflag,restore)</description>
            <value>flag</value>
    </param>

    <param type="string" name="outfile">
            <description>name of output file</description>
            <value></value>
    </param>

    <param type="string" name="outform">
            <description>output file format (ASCII,MS,SDFITS,ASAP)</description>
            <value>ASAP</value>
            <allowed kind="enum">
            <value>ASCII</value>
            <value>ascii</value>
            <value>MS</value>
            <value>ms</value>
            <value>MS2</value>
            <value>ms2</value>
            <value>SDFITS</value>
            <value>sdfits</value>
            <value>ASAP</value>
            <value>asap</value>
            </allowed>

    </param>

    <param type="bool" name="overwrite">
            <description>overwrite the output file if already exists</description>
            <value>False</value>
    </param>

    <param type="int" name="plotlevel">
            <description>control for plotting of results</description>
            <value>0</value>
    </param>

    <constraints>
    </constraints>

    </input>

  <returns type="void"/>

  <example>
        Keyword arguments:
        sdfile -- name of input SD dataset
        scanlist -- list of scan numbers to process
                default: [] (use all scans)
                example: [21,22,23,24]
                         this selection is in addition to field
                         and iflist
        field -- selection string for selecting scans by name
                default: '' (no name selection)
                example: 'FLS3a*'
                         this selection is in addition to scanlist
                         and iflist
        iflist -- list of IF id numbers to select
                default: [] (use all IFs)
                example: [15]
                         this selection is in addition to scanlist
                         and field
        pollist -- list of polarization id numbers to select
                default: [] (use all polarizations)
                example: [1]
                         this selection is in addition to scanlist,
                         field, and iflist
        maskflag -- list of mask regions to apply flag/unflag 
                default: [] (entire spectrum)
                example: [[1000,3000],[5000,7000]]
                WARNING: if one or more rows are given in flagrow, 
                         this parameter is ignored
        flagrow -- list of row numbers to apply flag/unflag (row-based)
                default: [] (no row selection)
                example: [0, 2, 3]
                WARNING: this parameter is effective only when 
                         one or more row numbers are given explicitly
        flagmode -- flag mode
                default: 'flag'
                options: 'flag','unflag','restore'
                         in 'restore' mode, a history of flagging is 
                         displayed and current flag state is returned
        outfile -- Name of output file
                default: '' (&lt;sdfile&gt;_f)
        outform -- format of output file
                options: 'ASCII','SDFITS','MS','ASAP'
                default: 'ASAP'
                example: the ASAP format is easiest for further sd
                         processing; use MS for CASA imaging.
        overwrite -- overwrite the output file if already exists
                options: (bool) True,False
                default: False
                WARNING: if outform='ASCII', this parameter is ignored 
        plotlevel -- control for plotting of results
                options: (int) 0=none, 1=some, 2=more, &lt;0=hardcopy
                default: 0 (no plotting)
                example: plotlevel&lt;0 as abs(plotlevel), e.g.
                         -1 => hardcopy of final plot (will be named
                         &lt;outfile&gt;_flag.eps)
                WARNING: be careful plotting in fsotf mode!

        -------------------------------------------------------------------
        Returns: Current values of maskflag for each spectrum as a list, 
                 only if flagmode is set to 'restore'. Note that the 
                 'restore' mode refers scanlist, iflist, and pollist.

        DESCRIPTION:

        Task sdflag performs simple channel/row based flagging on spectra.
        Channel based flagging and row based flagging can not be executed
        simultaneously: channel based flagging can be executed using the 
        flag regions specified in maskflag if no row is given in flagrow,
        whereas row based flagging is executed when one or more rows are
        specified in flagrow.
        This is not interactive flagging. If plotlevel&gt;=1, the task asks
        you if you really apply the flags before it is actually written 
        to the data with a plot indicating flagged regions.
        The flags are not written to the current (input) datasets unless 
        outfile='none'.
        Please note that this task is still experimental.

        WARNING for the GBT raw SDFITS format data as input:
        Currently, all SDtasks cannot handle GBT raw SDFITS format data
        (in which the data are stored in multiple tables within SDFITS).
        It may be still possible to reduce GBT data after some
        preprocessing (outside CASA) of the raw SDFITS to a SDFITS with
        a single data table or to other data formats handled by SDtasks.
 
  </example>

</task>

</casaxml>
